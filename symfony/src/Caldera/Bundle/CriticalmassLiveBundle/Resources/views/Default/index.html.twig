{% extends 'CalderaCriticalmassLiveBundle:Template:MasterTemplate.html.twig' %}

{% block content %}
<div class="container m-t-5">
    <div class="row">
        <div class="col-xs-6 offset-xs-3">
            {% if rides | length > 0 %}
            <form name="" class="form-inline">
                <div class="row">
                    <div class="col-xs-12 text-xs-center">
                        <h2>
                            Auf den Sattel, fertig los
                        </h2>
                    </div>
                </div>

                <div class="row">
                    <div class="col-xs-12 text-xs-center">
                        <p class="lead">
                            Wo bist du heute unterwegs?
                        </p>
                    </div>
                </div>

                <div class="row">
                    <div class="col-xs-12 text-xs-center">
                        <select class="form-control" id="select-ride">
                            {% for ride in rides %}
                                {% if (ride.hasLocation() and ride.latitude and ride.longitude) %}
                                {% set latitude = ride.latitude %}
                                {% set longitude = ride.longitude %}
                                {% else %}
                                {% set latitude = ride.city.latitude %}
                                {% set longitude = ride.city.longitude %}
                                {% endif %}
                                <option data-city-slug="{{ ride.city.slug }}" data-latitude="{{ latitude }}" data-longitude="{{ longitude }}">
                                    {{ ride.city.city }}
                                </option>
                            {% endfor %}
                        </select>
                    </div>
                </div>

                <div class="row m-t-1">
                    <div class="col-xs-12 text-xs-center">
                        <div class="btn-group">
                            <button id="ride-on" type="submit" class="btn btn-success">
                                Ride on
                            </button>
                            <button id="auto-select" type="button" class="btn btn-default">
                                Autoselect
                            </button>
                        </div>
                    </div>
                </div>
            </form>
            {% else %}
            <div class="row">
                <div class="col-xs-12 text-xs-center">
                    <h2>
                        Nichts los auf den Straßen
                    </h2>
                </div>
            </div>

            <div class="row">
                <div class="col-xs-12 text-xs-center">
                    <p class="lead">
                        Leider ist momentan keine kritische Masse unterwegs. Schau dir die <a href="{{ path('caldera_criticalmass_desktop_city_list') }}">Liste weltweiter Critical-Mass-Touren</a> an, um eine Tour in deiner Nähe zu finden.
                    </p>
                </div>
            </div>
            {% endif %}
        </div>
    </div>

    {% set citiesPerCol = (cities | length / 3) | round(0, 'floor') %}
    {{ citiesPerCol }}
    <div class="row m-t-5">
        <div class="col-md-4">
            <ul class="list-unstyled">
                {% for city in cities|slice(0, citiesPerCol) %}
                <li>
                    {{ city }}
                </li>
                {% endfor %}
            </ul>
        </div>
        <div class="col-md-4">
            <ul class="list-unstyled">
                {% for city in cities|slice(citiesPerCol, citiesPerCol) %}
                    <li>
                        {{ city }}
                    </li>
                {% endfor %}
            </ul>
        </div>
        <div class="col-md-4">
            <ul class="list-unstyled">
                {% for city in cities|slice(2 * citiesPerCol, citiesPerCol + 1) %}
                    <li>
                        {{ city }}
                    </li>
                {% endfor %}
            </ul>
        </div>
    </div>
</div>

<script>
    CriticalMass.loadModule('LiveFrontPage');
</script>
{% endblock  %}